@model BookDetailsModel


@{
    ViewBag.Title = "Home Page";
}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a asp-controller="Home" asp-action="Index">Home</a></li>
        <li class="breadcrumb-item"><a @*asp-controller="Home" asp-action="Index"*@>@Model.AuthorName</a></li>
        <li class="breadcrumb-item active" aria-current="page">@*<a asp-controller="Books" asp-action="Index">*@@Model.GenreName</li>
    </ol>
</nav>
    @*<div class="row">
            <div>
            <img class="mr-3 resp-img mt-3 w-25 p-3" src="@Model.ImagePath" alt="Generic placeholder image">
            </div>
            <div>
                <h4 itemprop="name" class="mt-3">@Model.Name</h4>
                <ul class="desc-info-book">
                    <li>Автор: <span itemprop="author" style="float:right;" itemscope="" itemtype="http://schema.org/Person"><a href="/%D0%9C%D0%B0%D0%BD%D1%83%D0%B5%D0%BB%D0%B0+%D0%98%D0%BD%D1%83%D1%81%D0%B0-s"><span itemprop="name">Мануела Инуса</span></a></span></li>
                    <li>ISBN:	<span itemprop="isbn" style="float:right;">9789542619536</span></li>
                    <li>Език:	<a href="/balgarski-1-lang"><span itemprop="inLanguage" style="float:right;">български</span></a></li>
                    <li>Категория: <a href="/hudozhestvena-literatura-6-genre"><span itemprop="genre" style="float:right;">Художествена литература</span></a></li>
                    <li>Книгата се намира в <a href="/karnobat-206-city" target="_blank" style="float:right;">Карнобат</a></li>
                    <li>
                        Книгата се

                        <span class="price-free" style="float:right;">РАЗМЕНЯ</span>

                    </li>

                    <li><div itemprop="offers" itemscope="" itemtype="http://schema.org/Offer">Потребителят би я продал за <span class="price-desc" style="float:right;"><span itemprop="price">8</span><span itemprop="priceCurrency" content="BGN">лв</span></span></div></li>

                </ul>
            </div>
        </div>
        </div>*@
    <div >

            <div class="media">
                <img img class="mr-3 resp-img mt-3 w-25 p-3 col-3" src="@Model.ImagePath" alt="Generic placeholder image">
                <div class="media-body col-4 mt-3">
                    <h4 itemprop="name" class="desc-title">@Model.Name</h4>
                    <ul class="desc-info-book">
                        <li>Author: <span itemprop="author" style="float:right;" itemscope="" itemtype="http://schema.org/Person"><a asp-controller="Books" asp-action="Filter" asp-route-authorName="@Model.AuthorName"><span itemprop="name">@Model.AuthorName</span></a></span></li>
                        <li>ISBN:	<span itemprop="isbn" style="float:right;">@Model.Isbn</span></li>
                        <li>Language:	<a asp-controller="Books" asp-action="Filter" asp-route-languageName="@Model.LanguageName"><span itemprop="inLanguage" style="float:right;">@Model.LanguageName</span></a></li>
                        <li>Genre: <a asp-controller="Books" asp-action="Filter" asp-route-genreName="@Model.GenreName"><span itemprop="genre" style="float:right;">@Model.GenreName</span></a></li>
                        <li>The book is located in: <a asp-controller="Books" asp-action="Filter" asp-route-townName="@Model.TownName" target="_blank" style="float:right;">@Model.TownName</a></li>
                        <li>
                            The book is for
                            <span class="price-free" style="float:right;">@Model.TheBookIsFor</span>
                        </li>
                        <li><div itemprop="offers" itemscope="" itemtype="http://schema.org/Offer">The Knizhar would sell it for<span class="price-desc" style="float:right;"><span itemprop="price">@Model.Price</span><span itemprop="priceCurrency" content="BGN">BGN</span></span></div></li>
                    </ul>
                    <h4 itemprop="name" class="desc-title">Knizhar Information</h4>
                    <ul class="desc-info-book">
                        <li>Name: <a @*asp-controller="Books" asp-action="Filter" asp-route-genreName="@Model.GenreName"*@><span itemprop="genre" style="float:right;">@Model.KnizharName</span></a></li>
                        <li>Town: <a asp-controller="Books" asp-action="Filter" asp-route-townName="@Model.TownName" target="_blank" style="float:right;">@Model.TownName</a></li>
                    </ul>
                    <h6 class="heading">User Rating</h6>
                    <ul>
                        <li class="fa fa-star" id="rating" data-vote="1"></li>
                        <li class="fa fa-star" id="rating" data-vote="2"></li>
                        <li class="fa fa-star" id="rating" data-vote="3"></li>
                        <li class="fa fa-star" id="rating" data-vote="4"></li>
                        <li class="fa fa-star" id="rating" data-vote="5"></li>
                    </ul>
                    <p id="averageVoteValue"> @Model.AverageVote.ToString("0.0")<span> average based on @Model.TotalVotes reviews.</span></p>
                </div>
        </div>
    </div>
<form method="post" id="antiforgeryForm"></form>
@section Scripts{ 
<script>
    $("li[data-vote]").each(function (el) {
        $(this).click(function () {
            var value = $(this).attr("data-vote");
            var knizharId = @Model.KnizharId;
            var antiForgeryToken = $('#antiforgeryForm input[name=__RequestVerificationToken]').val();
            var data = { knizharId: knizharId, value: value };

            $.ajax({
                type: "POST",
                url: '/api/votes',
                data: JSON.stringify(data),
                headers: {
                    'X-CSRF-TOKEN': antiForgeryToken
                },
                success: function (data) {
                    $('#averageVoteValue').html(data.averageVote.toFixed(1))
                },
                contentType: 'application/json',
            });
        })
    })
 </script>
}